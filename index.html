<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="description"/><meta name="keywords" content="keywords" /><link rel="alternate" href="https://github.com/paper00/paper00.github.io/issues" title="Euphoria"><link rel="shortcut icon" type="image/x-icon" href="/cookie128px.ico?v=2.11.0" />
<link rel="canonical" href="https://paper00.github.io/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>Euphoria</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Euphoria</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Euphoria</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2020/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCP:IP%20OSI%E6%A8%A1%E5%9E%8B/">TCP/IP ä¹‹ OSI æ¨¡å‹</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-02-11
        </span><span class="post-category">
            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">è®¡ç®—æœºç½‘ç»œ</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="OSI-æ¨¡å‹ä¼ è¾“æ•°æ®è¿‡ç¨‹"><a href="#OSI-æ¨¡å‹ä¼ è¾“æ•°æ®è¿‡ç¨‹" class="headerlink" title="OSI æ¨¡å‹ä¼ è¾“æ•°æ®è¿‡ç¨‹"></a>OSI æ¨¡å‹ä¼ è¾“æ•°æ®è¿‡ç¨‹</h2><p><img src="/images/OSI2.png" alt="OSIæ¨¡å‹"></p>
<ol>
<li>åº”ç”¨å±‚<ul>
<li>OS ä¸Šçš„åº”ç”¨ç¨‹åº</li>
<li>æ ‡å‡† HTTP 80</li>
<li>æ ‡å‡† HTTPS 443</li>
<li>æ ‡å‡† FTP 21</li>
</ul>
</li>
<li>è¡¨ç¤ºå±‚<ul>
<li>è½¬åŒ–æ ¼å¼ (PNG JPEG AVI MP4 ç­‰)</li>
<li>åŠ å¯†</li>
</ul>
</li>
<li>ä¼šè¯å±‚<ul>
<li>å»ºç«‹ sessionã€ç®¡ç†ã€ç»´æŠ¤</li>
</ul>
</li>
<li>ä¼ è¾“å±‚<ul>
<li>æ–¹å¼ -&gt; TCP / UDP åè®®</li>
<li>ssh æœåŠ¡</li>
</ul>
</li>
<li>ç½‘ç»œå±‚<ul>
<li>è·¯ç”±å™¨ï¼ˆå®ƒä¼šäºŒæ¬¡å°åŒ…ï¼‰</li>
<li>IP åè®®</li>
</ul>
<ol>
<li>ä¸ºæ¯ä¸€æ¬¡è®¡ç®—æœºåˆ†é…ä¸€ä¸ª IP åœ°å€</li>
<li>ç¡®å®šå“ªäº›åœ°å€åœ¨<code>åŒä¸€ä¸ªå­ç½‘</code>å†…</li>
</ol>
<ul>
<li>å…¬ç½‘ IP</li>
<li>ç§ç½‘ IP</li>
</ul>
<ol>
<li>A ç±»åœ°å€ï¼š10.0.0.0â€”10.255.255.255ï¼›</li>
<li>B ç±»åœ°å€ï¼š172.16.0.0â€”172.31.255.555ï¼›</li>
<li>C ç±»åœ°å€ï¼š192.168.0.0â€”192.168.255.255ï¼›</li>
</ol>
<ul>
<li>ğŸ‘‡ IP åœ°å€</li>
<li>(110.47.189.108)</li>
</ul>
</li>
<li>æ•°æ®é“¾è·¯å±‚<ul>
<li>äº¤æ¢æœº æˆ–è€… HUB?</li>
<li>ğŸ‘‡ MAC åœ°å€</li>
<li>(fa:aa:14:91:3d:be) </li>
</ul>
</li>
<li>ç‰©ç†å±‚<ul>
<li>(010100010010199)</li>
</ul>
</li>
</ol>
<blockquote>
<p>åº”ç”¨å±‚ ~ ä¼šè¯å±‚ ï¼šæ•°æ®å¤„ç†</p>
</blockquote>
<blockquote>
<p>ä¼ è¾“å±‚ ~ ç‰©ç†å±‚ ï¼šç½‘ç»œé€šä¿¡</p>
</blockquote>
<h2 id="çŸ¥è¯†æ•´ç†"><a href="#çŸ¥è¯†æ•´ç†" class="headerlink" title="çŸ¥è¯†æ•´ç†"></a>çŸ¥è¯†æ•´ç†</h2><ul>
<li>å¦‚æœåœ¨åŒä¸€ä¸ª<code>å­ç½‘</code>ä¸‹ï¼Œé‡‡ç”¨<code>å¹¿æ’­</code>çš„æ–¹å¼ä¼ æ’­</li>
<li>å¦åˆ™ï¼Œä½¿ç”¨<code>è·¯ç”±</code>çš„æ–¹å¼</li>
<li>MAC åœ°å€åªä¸å‚å•†æœ‰å…³ç³»ï¼Œ<code>ä¸èƒ½</code>åˆ¤æ–­å“ªäº› MAC åœ°å€å¤„äºåŒä¸€ä¸ª<code>å­ç½‘</code>ï¼Œæ‰€ä»¥éœ€è¦<code>ç½‘ç»œå±‚</code>çš„æ”¯æŒ</li>
<li>ç½‘ç»œå±‚å‡ºç°ä¹‹åï¼Œæ¯å°è®¡ç®—æœºæœ‰ä¸¤ä¸ªåœ°å€ï¼Œä¸€ç§æ˜¯ <code>MAC åœ°å€</code>ï¼Œå¦ä¸€ç§æ˜¯<code>ç½‘ç»œåœ°å€</code><ol>
<li><code>ç½‘ç»œåœ°å€</code>èƒ½å¤Ÿç¡®å®šè¯¥è®¡ç®—æœºæ‰€åœ¨çš„<code>å­ç½‘ç»œ</code></li>
<li><code>MAC åœ°å€</code>æ˜¯ç»‘å®šåœ¨<code>ç½‘å¡</code>ä¸Š, èƒ½å¤ŸæŠŠ<code>æ•°æ®åŒ…</code>å‘é€åˆ°<code>å­ç½‘ç»œ</code>ä¸­çš„<code>ç›®æ ‡ç½‘å¡</code>ä¸Š</li>
</ol>
</li>
<li>æ‰€ä»¥å…ˆå¤„ç†ç½‘ç»œåœ°å€ï¼Œå†å¤„ç† MAC åœ°å€ï¼Œ</li>
<li>ç½‘ç»œå±‚çš„ IP åè®®ä¸­ (æœ€å¹¿æ³›ipv4)<br><img src="/images/ip.png" alt="IP"><ol>
<li>8 + 8 + 8 + 8 = 32ä½</li>
<li>255.255.255.0ï¼ˆå­ç½‘æ©ç ï¼‰</li>
</ol>
</li>
<li><code>IP åè®®</code>çš„ä¸»è¦ä½œç”¨<ol>
<li>ä¸ºæ¯ä¸€æ¬¡è®¡ç®—æœºåˆ†é…ä¸€ä¸ª IP åœ°å€</li>
<li>ç¡®å®šå“ªäº›åœ°å€åœ¨<code>åŒä¸€ä¸ªå­ç½‘</code>å†…</li>
</ol>
</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯¹æ–¹çš„ IP æ˜¯å·²çŸ¥çš„ï¼Œä½† MAC åœ°å€æ˜¯ä¸çŸ¥é“çš„ã€‚</li>
<li>å¦‚æœä¸¤å°è®¡ç®—æœºä¸åœ¨åŒä¸€ä¸ª<code>å­ç½‘ç»œ</code>ï¼šå› ä¸ºæ— æ³•çŸ¥é“å¯¹æ–¹çš„ MAC åœ°å€ï¼Œåªèƒ½æŠŠæ•°æ®åŒ…ä¼ é€åˆ°ä¸¤ä¸ªå­ç½‘ç»œè¿æ¥çš„ç½‘å…³å–å¤„ç†</li>
<li>å¦‚æœä¸¤å°è®¡ç®—æœºåœ¨åŒä¸€ä¸ª<code>å­ç½‘ç»œ</code>ï¼šå¯ä»¥ç”¨ <code>ARP åè®®</code></li>
<li><code>ARP åè®®</code> æ˜¯æ ¹æ® <code>IP åœ°å€</code> è·å– <code>MAC åœ°å€</code>çš„ä¸€ä¸ª TCP/IP åè®®<ol>
<li>ä»¥å¤ªç½‘çš„æ•°æ®åŒ…ä¸­åŒ…å«äº†ç›®æ ‡ä¸»æœºçš„ IP åœ°å€ï¼Œä½†ä¸åŒ…å« MAC åœ°å€</li>
<li>å¹¿æ’­çš„æ–¹å¼ä¼ é€’æ•°æ®åŒ…æ—¶ï¼Œåœ¨å­ç½‘ä¸‹çš„æ‰€æœ‰ä¸»æœºéƒ½ä¼šå—åˆ°æ•°æ®åŒ…</li>
<li>æ¯ä¸ªä¸»æœºåˆ¤æ–­æ•°æ®åŒ…ä¸­çš„ IP åœ°å€å–å‡ºæ¥ï¼Œå’Œè‡ªå·±çš„ IP åœ°å€åšæ¯”è¾ƒã€‚å¦‚æœç›¸åŒï¼Œåˆ™æŠŠè‡ªå·±çš„ MAC åœ°å€ä¸ŠæŠ¥ä¸Šå»ï¼›å¦‚æœä¸ç›¸åŒï¼Œåˆ™ä¸¢å¼ƒè¿™ä¸ªåŒ…ï¼›</li>
</ol>
</li>
<li>æ¯ä¸€ä¸ªæ•°æ®åŒ…éƒ½ä¼šå‘é€åˆ°ä¸»æœºçš„ç‰¹å®šç«¯å£ï¼Œä¸åŒçš„ç¨‹åºå°±ä¼šå»åˆ°è‡ªå·±æ‰€éœ€è¦çš„æ•°æ®åŒ…<br><img src="/images/%E4%BC%A0%E8%BE%93%E5%B1%82&%E7%BD%91%E7%BB%9C%E5%B1%82.png" alt="IP"></li>
<li>UDP åè®®ï¼Œå¯é æ€§å·®ï¼Œå‘é€æ•°æ®åŒ…ä¹‹åä¸çŸ¥é“å¯¹æ–¹æœ‰æ²¡æœ‰æ”¶åˆ°<ol>
<li>æ— è¿æ¥</li>
<li>ä¸å¯é </li>
<li>å®æ—¶æ€§å¼º</li>
<li>ä¸€å¯¹ä¸€ï¼Œå¤šå¯¹ä¸€ï¼Œå¤šå¯¹å¤š</li>
<li>èµ„æºæ¶ˆè€—è¾ƒå°‘</li>
</ol>
</li>
<li>TCP åè®®ï¼Œå¯é ï¼Œä¸‰æ¬¡æ¡æ‰‹<ol>
<li>é¢å‘è¿æ¥</li>
<li>å¯é </li>
<li>ç‚¹å¯¹ç‚¹</li>
<li>èµ„æºæ¶ˆè€—é«˜<br><img src="/images/%E7%BD%91%E5%85%B3.png" alt="(ç½‘å…³"><br><img src="/images/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%AE%E6%A0%87%E5%9C%B0%E5%9D%80.png" alt="(æ•°æ®åŒ…ç›®æ ‡åœ°å€"></li>
</ol>
</li>
<li>TCP æ•°æ®åŒ…éœ€è¦è®¾ç½®ä¸€ä¸ª<code>ç«¯å£</code></li>
<li>IP æ•°æ®åŒ…éœ€è¦è·‘ç½®ä¸€ä¸ªåŒæ–¹çš„<code>IP åœ°å€</code>ï¼Œå‘é€æ–¹æ˜¯æœ¬æœº</li>
<li>ä»¥å¤ªç½‘æ•°æ®åŒ…éœ€è¦è®¾ç½®åŒæ–¹çš„<code>MAC åœ°å€</code>ï¼Œå‘é€æ–¹æ˜¯æœ¬æœºçš„ç½‘å¡ MAC åœ°å€ï¼Œæ¥æ”¶æ–¹ç½‘å…³çš„ MAC åœ°å€</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2020/01/21/Java/Spring%20Boot%20%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/">Spring Boot åŸºäºæ³¨è§£çš„é¢å‘åˆ‡é¢ç¼–ç¨‹</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-01-21
        </span><span class="post-category">
            <a href="/categories/Java/">Java</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="AOP-åœ¨-Spring-Boot-ä¸­çš„åº”ç”¨"><a href="#AOP-åœ¨-Spring-Boot-ä¸­çš„åº”ç”¨" class="headerlink" title="AOP åœ¨ Spring Boot ä¸­çš„åº”ç”¨"></a>AOP åœ¨ Spring Boot ä¸­çš„åº”ç”¨</h2><ul>
<li>è‡ªå®šä¹‰æƒé™æ³¨è§£<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yzyx.repomanage.aop;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Permission &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æƒé™å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span>	</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br></li>
<li>è·å–æ³¨è§£å‚æ•°å€¼<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yzyx.repomanage.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParsePermission</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">parse</span><span class="params">(Class targetClass, String methodName, JoinPoint joinPoint)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–æ–¹æ³•</span></span><br><span class="line">        MethodSignature methodSignature = (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        Method method = methodSignature.getMethod();</span><br><span class="line">        String value = <span class="string">""</span>;</span><br><span class="line">        <span class="comment">// å¦‚æœæ–¹æ³•å¸¦äº†æ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(Permission.class)) &#123;</span><br><span class="line">            Permission permission = method.getAnnotation(Permission.class);</span><br><span class="line">            value = permission.value();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br></li>
<li>AOP åˆ‡é¢æƒé™æ§åˆ¶<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yzyx.repomanage.aop;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PermissionAspect</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    RoleUserService roleUserService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    RoleAuthorityService roleAuthorityService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    AuthorityService authorityService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(public * com.yzyx.repomanage.controller.*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">aspectTarget</span><span class="params">()</span></span>&#123;</span><br><span class="line">        log.info(<span class="string">"è¿›è¡Œæƒé™éªŒè¯"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"aspectTarget()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">executeAround</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚ä¿¡æ¯</span></span><br><span class="line">        ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">        HttpServletRequest request = requestAttributes.getRequest();</span><br><span class="line">        HttpServletResponse response = requestAttributes.getResponse();</span><br><span class="line">        <span class="comment">// å¦‚æœå…·æœ‰æƒé™ï¼Œç»§ç»­æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        Object object = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (hasPermission(joinPoint, request)) &#123;</span><br><span class="line">            object = joinPoint.proceed();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.setHeader(<span class="string">"Content-type"</span>,<span class="string">"application/json; charset=UTF-8"</span>);</span><br><span class="line">            OutputStream outputStream = response.getOutputStream();</span><br><span class="line">            Result result = Result.UserError().appendInfo(<span class="string">"æƒé™ä¸è¶³"</span>);</span><br><span class="line">            outputStream.write(<span class="keyword">new</span> ObjectMapper().writeValueAsString(result).getBytes(<span class="string">"UTF-8"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">hasPermission</span><span class="params">(JoinPoint joinPoint, HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Class targetClass = joinPoint.getTarget().getClass();</span><br><span class="line">        String methodName = joinPoint.getSignature().getName();</span><br><span class="line">        <span class="comment">// è·å–æ‰§è¡Œæ–¹æ³•çš„æƒé™</span></span><br><span class="line">        String value = ParsePermission.parse(targetClass, methodName, joinPoint);</span><br><span class="line">        log.info(<span class="string">"[Required permission] &#123;&#125;"</span>, value);</span><br><span class="line">        <span class="keyword">if</span> (value.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»è¯·æ±‚å¤´ä¸­è·å–token</span></span><br><span class="line">        String token = request.getHeader(JwtTokenUtil.AUTH_HEADER_KEY);</span><br><span class="line">        <span class="keyword">if</span> (token != <span class="keyword">null</span>) &#123;</span><br><span class="line">            log.info(token);</span><br><span class="line">            Claims claims = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                claims = JwtTokenUtil.parseJWT(token);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UserException e) &#123;</span><br><span class="line">                log.error(e.getMessage());</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯å¦å…·æœ‰æƒé™</span></span><br><span class="line">            String username = claims.getSubject();</span><br><span class="line">            <span class="keyword">return</span> checkDatabase(value, username);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkDatabase</span><span class="params">(String value, String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> checked = <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">// è·å–ç”¨æˆ·å…·æœ‰çš„è§’è‰²</span></span><br><span class="line">        List&lt;RoleUser&gt; roleUserList = roleUserService.getRoleUsers(username);</span><br><span class="line">        <span class="comment">// è·å–è§’è‰²å…·æœ‰çš„æƒé™</span></span><br><span class="line">        List&lt;RoleAuthority&gt; roleAuthorityList = roleAuthorityService.getRoleAuthorities(roleUserList);</span><br><span class="line">        <span class="comment">// è·å–æƒé™åç§°</span></span><br><span class="line">        List&lt;Authority&gt; authorityList = authorityService.getAuthorities(roleAuthorityList);</span><br><span class="line">        <span class="keyword">for</span>(Authority authority : authorityList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (authority.getName().equals(value)) &#123;</span><br><span class="line">                checked = <span class="keyword">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> checked;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning</span>(returning = <span class="string">"response"</span>, pointcut = <span class="string">"aspectTarget()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterReturning</span><span class="params">(Object response)</span></span>&#123;</span><br><span class="line">        log.info(<span class="string">"[Response] "</span> + response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/11/11/Java/Spring%20Boot%20%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%87%AA%E5%8A%A8%E5%8A%A0%E8%A7%A3%E5%AF%86/">Spring Boot æ¥å£å‚æ•°è‡ªåŠ¨åŠ è§£å¯†</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-11-11
        </span><span class="post-category">
            <a href="/categories/Java/">Java</a>
            </span>
        </div>
    </header>

    <div class="post-content"><ul>
<li>Mavenï¼Œpom.xmlä¸­æ·»åŠ ä¾èµ–<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.shuibo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rsa-encrypt-body-spring-boot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<br></li>
<li>å¯åŠ¨ç±»Applicationä¸­æ·»åŠ @EnableSecurityæ³¨è§£<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br></li>
<li>åœ¨application.ymlæˆ–è€…application.propertiesä¸­æ·»åŠ RSAå…¬é’¥åŠç§é’¥<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">rsa:</span></span><br><span class="line"><span class="attr">  encrypt:</span></span><br><span class="line"><span class="attr">    debug:</span> <span class="literal">false</span> <span class="comment"># trueè¡¨ç¤ºå¼€å¯è°ƒè¯•ï¼Œä¸åŠ å¯†ã€‚ï¼ˆæ–¹ä¾¿å¼€å‘æ—¶æµ‹è¯•ï¼‰</span></span><br><span class="line"><span class="attr">    publicKey:</span> <span class="number">123456</span></span><br><span class="line"><span class="attr">    privateKey:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>
<br></li>
<li>å¯¹è¿”å›å€¼è¿›è¡ŒåŠ å¯†<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Encrypt</span></span><br><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/encryption"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> TestBean <span class="title">encryption</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TestBean testBean = <span class="keyword">new</span> TestBean();</span><br><span class="line">    testBean.setName(<span class="string">"shuibo.cn"</span>);</span><br><span class="line">    testBean.setAge(<span class="number">18</span>);</span><br><span class="line">    <span class="keyword">return</span> testBean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br></li>
<li>å¯¹ä¼ è¿‡æ¥çš„åŠ å¯†å‚æ•°è§£å¯†<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Decrypt</span></span><br><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/decryption"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Decryption</span><span class="params">(@RequestBody TestBean testBean)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> testBean.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

</li>
</ul>
<blockquote>
<p><a href="https://www.shuibo.cn/" target="_blank" rel="noopener">å‚è€ƒ</a></p>
</blockquote>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/10/25/scrap/Snowflake-%E9%9B%AA%E8%8A%B1%E7%AE%97%E6%B3%95/">Snowflake é›ªèŠ±ç®—æ³•</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-10-25
        </span><span class="post-category">
            <a href="/categories/scrap/">scrap</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h1 id="ä¸ºä»€ä¹ˆä½¿ç”¨é›ªèŠ±ç®—æ³•ï¼Ÿâ„ï¸"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨é›ªèŠ±ç®—æ³•ï¼Ÿâ„ï¸" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨é›ªèŠ±ç®—æ³•ï¼Ÿâ„ï¸"></a>ä¸ºä»€ä¹ˆä½¿ç”¨é›ªèŠ±ç®—æ³•ï¼Ÿâ„ï¸</h1><p>&emsp;åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œå¾€å¾€éœ€è¦å¯¹å¤§é‡çš„æ•°æ®å¦‚è®¢å•ï¼Œè´¦æˆ·è¿›è¡Œæ ‡è¯†ï¼Œä»¥ä¸€ä¸ªæœ‰æ„ä¹‰çš„æœ‰åºçš„åºåˆ—å·æ¥ä½œä¸ºå…¨å±€å”¯ä¸€çš„IDï¼Œå³éœ€è¦ä¸€ä¸ª<code>IDå·ç”Ÿæˆå™¨</code>ã€‚</p>
<p>&emsp;IDå·ç”Ÿæˆå™¨æ˜¯æœåŠ¡ç«¯ç³»ç»Ÿçš„åŸºç¡€è®¾æ–½ï¼Œè€Œä¸”<code>IDå·</code>è¿™ä¸ªä¸œè¥¿åŸºæœ¬æåç«¯å¼€å‘çš„ç¨‹åºå‘˜å¤©å¤©éƒ½è¦æ¥è§¦ã€‚è€Œå…³äº<code>IDç”Ÿæˆçš„ç®—æ³•</code>ç°åœ¨ä¸šç•Œé¦–å±ˆä¸€æŒ‡çš„å½“å±<code>Snowflake</code>é›ªèŠ±ç®—æ³•ã€‚</p>
<h1 id="å¸¸è§ä¼ä¸šçº§ä½¿ç”¨çš„æ–¹æ¡ˆ"><a href="#å¸¸è§ä¼ä¸šçº§ä½¿ç”¨çš„æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§ä¼ä¸šçº§ä½¿ç”¨çš„æ–¹æ¡ˆ"></a>å¸¸è§ä¼ä¸šçº§ä½¿ç”¨çš„æ–¹æ¡ˆ</h1><h4 id="1-UUID"><a href="#1-UUID" class="headerlink" title="1. UUID"></a>1. UUID</h4><p>UUID = 4ä¸ªè¿å­—å·(-) + 32ä¸ªå­—èŠ‚é•¿çš„å­—ç¬¦ä¸²ï¼Œæ€»å…±36ä¸ªå­—èŠ‚é•¿ã€‚æ¯”å¦‚ï¼š</p>
<blockquote>
<p>550e8400-e29b-41d4-a716-446655440000</p>
</blockquote>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ol>
<li>èƒ½å¤Ÿä¿è¯ <code>ç‹¬ç«‹æ€§</code>ã€‚ <br></li>
<li>ç¨‹åºå¯ä»¥åœ¨ä¸åŒçš„ <code>æ•°æ®åº“é—´è¿ç§»</code>ï¼Œæ•ˆæœä¸å—å½±å“ã€‚</li>
</ol>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ol>
<li>ä¸æ˜“äºå­˜å‚¨ / æ€§èƒ½é—®é¢˜ï¼šUUIDå¤ªé•¿ï¼Œ128ä½ã€36é•¿åº¦å­—ç¬¦ï¼Œä¸åˆ©äºMysqlç´¢å¼•ï¼ˆåœ¨InnoDBå¼•æ“ä¸‹ï¼Œ<code>UUIDçš„æ— åºæ€§</code> å¯èƒ½ä¼šå¼•èµ·æ•°æ®ä½ç½®é¢‘ç¹å˜åŠ¨ï¼Œä¸¥é‡å½±å“<code>æ€§èƒ½</code>ï¼‰ï¼Œå¾ˆå¤šåœºæ™¯ä¸é€‚ç”¨ã€‚</li>
<li>é‡‡ç”¨<code>æ— æ„ä¹‰å­—ç¬¦ä¸²</code>ï¼Œæ•°æ®é‡å¢å¤§æ—¶é€ æˆè®¿é—®è¿‡æ…¢ï¼Œä¸”<code>ä¸å®œæ’åº</code>ã€‚</li>
<li>ä¿¡æ¯ä¸å®‰å…¨ï¼šåŸºäºMACåœ°å€ç”ŸæˆUUIDçš„ç®—æ³•å¯èƒ½ä¼šé€ æˆMACåœ°å€æ³„éœ²ï¼Œè¿™ä¸ªæ¼æ´æ›¾è¢«ç”¨äºå¯»æ‰¾æ¢…ä¸½èç—…æ¯’çš„åˆ¶ä½œè€…ä½ç½®ã€‚</li>
</ol>
<h4 id="2-åŸºäºæ•°æ®åº“æ–¹æ¡ˆ"><a href="#2-åŸºäºæ•°æ®åº“æ–¹æ¡ˆ" class="headerlink" title="2. åŸºäºæ•°æ®åº“æ–¹æ¡ˆ"></a>2. åŸºäºæ•°æ®åº“æ–¹æ¡ˆ</h4><p>è‡ªå¢IDï¼šå¯¹äºæ•°æ®æ•æ„Ÿåœºæ™¯ä¸å®œä½¿ç”¨ï¼Œä¸”ä¸é€‚åˆäº<code>åˆ†å¸ƒå¼åœºæ™¯</code>ã€‚</p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ol>
<li>ç®€å•ï¼Œæˆæœ¬å°</li>
<li>IDå·å•è°ƒè‡ªå¢ï¼Œå¯ä»¥å®ç°ä¸€äº›å¯¹IDæœ‰ç‰¹æ®Šè¦æ±‚çš„ä¸šåŠ¡ã€‚</li>
</ol>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ol>
<li>ä¸åŒ<code>æ•°æ®åº“</code>è¯­æ³•å’Œå®ç°ä¸åŒï¼Œæ•°æ®åº“<code>è¿ç§»</code>çš„æ—¶å€™æˆ–<code>å¤šæ•°æ®åº“ç‰ˆæœ¬</code>æ”¯æŒçš„æ—¶å€™éœ€è¦å¤„ç†ã€‚</li>
<li>å¦‚æœæ¶‰åŠå¤šä¸ªç³»ç»Ÿéœ€è¦åˆå¹¶æˆ–è€…æ•°æ®è¿ç§»ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚</li>
</ol>
<h4 id="3-é›ªèŠ±ç®—æ³•"><a href="#3-é›ªèŠ±ç®—æ³•" class="headerlink" title="3. é›ªèŠ±ç®—æ³•"></a>3. é›ªèŠ±ç®—æ³•</h4><p><img src="http://www.dubby.cn/upload/1508161671799snowflake-64bit.jpg" alt="snowflake-64bit"><br>ç®—æ³•æè¿°ï¼š</p>
<ul>
<li>æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œå§‹ç»ˆä¸º0ï¼Œä¸å¯ç”¨ã€‚</li>
<li>41ä½çš„æ—¶é—´åºåˆ—ï¼Œç²¾ç¡®åˆ°æ¯«ç§’çº§ï¼Œ41ä½çš„é•¿åº¦å¯ä»¥ä½¿ç”¨69å¹´ã€‚æ—¶é—´ä½è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ä½œç”¨æ˜¯å¯ä»¥æ ¹æ®<code>æ—¶é—´</code>è¿›è¡Œ<code>æ’åº</code>ã€‚</li>
<li>10ä½çš„<code>æœºå™¨</code> æ ‡è¯†ï¼Œ10ä½çš„é•¿åº¦æœ€å¤šæ”¯æŒ<code>éƒ¨ç½²</code>1024ä¸ªèŠ‚ç‚¹ã€‚</li>
<li>12ä½çš„è®¡æ•°åºåˆ—å·ï¼Œåºåˆ—å·å³ä¸€ç³»åˆ—çš„<code>è‡ªå¢id</code>ï¼Œå¯ä»¥æ”¯æŒ<code>åŒä¸€èŠ‚ç‚¹</code>åŒä¸€æ¯«ç§’<code>ç”Ÿæˆå¤šä¸ªID</code>åºå·ï¼Œ<code>12ä½</code>çš„è®¡æ•°åºåˆ—å·æ”¯æŒæ¯ä¸ªèŠ‚ç‚¹æ¯æ¯«ç§’äº§ç”Ÿ<code>4096ä¸ª</code>IDåºå·ã€‚</li>
</ul>
<p><code>UidGenerator</code>æ˜¯ç™¾åº¦å¼€æºçš„ä¸€æ¬¾åŸºäº<code>Snowflake</code>é›ªèŠ±ç®—æ³•å®ç°çš„é«˜æ€§èƒ½å”¯ä¸€IDç”Ÿæˆå™¨ã€‚ä»¥ä¸‹æ˜¯å†è¿›è¡Œå°è£…çš„ä¸€å¥—æ›´åˆ©äºSpring Booté¡¹ç›®ä½¿ç”¨çš„IDå·ç”Ÿæˆç»„ä»¶ï¼Œå‘½åä¸ºid-spring-boot-starterã€‚</p>
<blockquote>
<p><a href="https://www.codesheep.cn/2019/09/04/id-springbt-starter/" target="_blank" rel="noopener">å‚è€ƒ</a></p>
</blockquote>
<h3 id="åœ¨-Spring-Boot-é¡¹ç›®ä¸­çš„ç”¨æ³•"><a href="#åœ¨-Spring-Boot-é¡¹ç›®ä¸­çš„ç”¨æ³•" class="headerlink" title="åœ¨ Spring Boot é¡¹ç›®ä¸­çš„ç”¨æ³•"></a>åœ¨ Spring Boot é¡¹ç›®ä¸­çš„ç”¨æ³•</h3><ul>
<li>å¯¼å…¥SQLè„šæœ¬</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> WORKER_NODE;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> WORKER_NODE</span><br><span class="line">(</span><br><span class="line"><span class="keyword">ID</span> <span class="built_in">BIGINT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'auto increment id'</span>,</span><br><span class="line">HOST_NAME <span class="built_in">VARCHAR</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'host name'</span>,</span><br><span class="line">PORT <span class="built_in">VARCHAR</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'port'</span>,</span><br><span class="line"><span class="keyword">TYPE</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'node type: ACTUAL or CONTAINER'</span>,</span><br><span class="line">LAUNCH_DATE <span class="built_in">DATE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'launch date'</span>,</span><br><span class="line">MODIFIED <span class="built_in">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'modified time'</span>,</span><br><span class="line">CREATED <span class="built_in">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'created time'</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(<span class="keyword">ID</span>)</span><br><span class="line">)</span><br><span class="line"> <span class="keyword">COMMENT</span>=<span class="string">'DB WorkerID Assigner for UID Generator'</span>,<span class="keyword">ENGINE</span> = <span class="keyword">INNODB</span>;</span><br></pre></td></tr></table></figure>

<p>UidGeneratoréœ€è¦æ•°æ®åº“æ”¯æŒ</p>
<ul>
<li>pomä¸­åŠ å…¥ä¾èµ–</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.codesheep<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>id-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>é…ç½®æ•°æ®åº“è¿æ¥</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="attr">jdbc:mysql://xxx.xxx.xxx.xxx:3306/demo?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;useOldAliasMetadataBehavior=true&amp;connectionCollation=utf8mb4_unicode_ci&amp;rewriteBatchedStatements=true&amp;allowMultiQueries=true</span></span><br><span class="line"><span class="attr">username:</span> <span class="string">xxxxxx</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">xxxxxx</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ä¿®æ”¹ Spring Boot ä¸»ç±»  </li>
</ul>
<p>Spring Bootåº”ç”¨ä¸»ç±»ä¸ŠåŠ ä¸Šmybatisæ³¨è§£å³å¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> UidGenService uidGenService;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@GetMapping</span>(<span class="string">"/uid"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">genUid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> String.valueOf(<span class="string">"æœ¬æ¬¡ç”Ÿæˆçš„å”¯ä¸€IDå·ä¸ºï¼š"</span>+uidGenService.getUid());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>é¦–å…ˆç”¨ Autowiredçš„æ–¹å¼å¼•å…¥UidGenServiceç±»ï¼›</li>
<li>ç›´æ¥è°ƒç”¨UidGenServiceç±»çš„getUid()æ–¹æ³•å³å¯è·å¾—ä¸€ä¸ªLongå‹çš„IDå·</li>
</ol>
<p>&emsp;ä¸ºä»€ä¹ˆå«<code>é›ªèŠ±ç®—æ³•</code>å‘¢ï¼Ÿç§ä»¥ä¸ºä¼—æ‰€å‘¨çŸ¥ä¸–ç•Œä¸Šæ²¡æœ‰ä¸€å¯¹ç›¸åŒçš„é›ªèŠ±ï¼Œè€Œé›ªèŠ±å½¢æˆçš„è¿‡ç¨‹ä¸­å¤æ‚çš„ç¯å¢ƒæ¡ä»¶åˆ™å¯¹åº”äº†é›ªèŠ±ç®—æ³•ä¸­çš„æœºå™¨ID,æ—¶é—´æˆ³åœ¨ç°å®å±‚é¢ä¸Šèƒ½å¤Ÿç²¾ç¡®åˆ°æ™®æœ—å…‹æ—¶é—´10^-43sï¼Œè¿™æ ·æ—¶é—´æˆ³çš„é•¿åº¦ä¹Ÿå¾—ä»¥ä¿è¯ã€‚</p>
<blockquote>
<p><a href="https://blog.csdn.net/Crazy_xym/article/details/100180398" target="_blank" rel="noopener">å‚è€ƒ</a></p>
</blockquote>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/10/25/scrap/MQ-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">MQ æ¶ˆæ¯é˜Ÿåˆ—</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-10-25
        </span></div>
    </header>

    <div class="post-content"><p>Message Queue</p>
<h3 id="åº”ç”¨åœºæ™¯ï¼ˆä¼˜ç‚¹ï¼‰"><a href="#åº”ç”¨åœºæ™¯ï¼ˆä¼˜ç‚¹ï¼‰" class="headerlink" title="åº”ç”¨åœºæ™¯ï¼ˆä¼˜ç‚¹ï¼‰"></a>åº”ç”¨åœºæ™¯ï¼ˆä¼˜ç‚¹ï¼‰</h3><ol>
<li>ä¸»è¦è§£å†³ <code>å¼‚æ­¥</code> æ¶ˆæ¯<br>ç”±äºåœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œç”±äºæ¥ä¸åŠåŒæ­¥å¤„ç†ï¼Œè¯·æ±‚å¾€å¾€ä¼šå‘ç”Ÿå µå¡ï¼Œæ¯”å¦‚è¯´ï¼Œå¤§é‡çš„insertï¼Œupdateä¹‹ç±»çš„è¯·æ±‚åŒæ—¶åˆ°è¾¾ mysqlï¼Œç›´æ¥å¯¼è‡´æ— æ•°çš„è¡Œé”è¡¨é”ï¼Œç”šè‡³æœ€åè¯·æ±‚ä¼šå †ç§¯è¿‡å¤šï¼Œä»è€Œè§¦å‘too many connectionsé”™è¯¯ã€‚é€šè¿‡ä½¿ç”¨ <code>MQ</code>ï¼Œæˆ‘ä»¬å¯ä»¥ <code>å¼‚æ­¥</code> å¤„ç†è¯·æ±‚ï¼Œä»è€Œç¼“è§£ç³»ç»Ÿçš„å‹åŠ›ã€‚</li>
<li>åº”ç”¨è§£è€¦</li>
<li>æµé‡æ¶ˆå³°ç­‰é—®é¢˜</li>
<li>æ—¥å¿—å¤„ç† (kafka)</li>
</ol>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>ç³»ç»Ÿå¯ç”¨æ€§é™ä½<br>æœ¬æ¥å…¶ä»–ç³»ç»Ÿåªè¦è¿è¡Œå¥½å¥½çš„ï¼Œé‚£ä½ çš„ç³»ç»Ÿå°±æ˜¯æ­£å¸¸çš„ã€‚ç°åœ¨ä½ éè¦åŠ ä¸ªæ¶ˆæ¯é˜Ÿåˆ—è¿›å»ï¼Œé‚£æ¶ˆæ¯é˜Ÿåˆ—æŒ‚äº†ï¼Œä½ çš„ç³»ç»Ÿå°±æŒ‚äº†ã€‚å› æ­¤ï¼Œç³»ç»Ÿå¯ç”¨æ€§é™ä½</li>
<li>ç³»ç»Ÿå¤æ‚æ€§å¢åŠ <br>è¦å¤šè€ƒè™‘å¾ˆå¤šæ–¹é¢çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸€è‡´æ€§é—®é¢˜ã€å¦‚ä½• <code>ä¿è¯</code> æ¶ˆæ¯ä¸è¢« <code>é‡å¤æ¶ˆè´¹</code>ï¼Œå¦‚ä½•ä¿è¯æ¶ˆæ¯ <code>å¯é ä¼ è¾“</code>ã€‚å› æ­¤ï¼Œéœ€è¦ <code>è€ƒè™‘</code> çš„ä¸œè¥¿æ›´å¤šï¼Œç³»ç»Ÿå¤æ‚æ€§å¢å¤§ã€‚</li>
</ul>
<ol>
<li>ä¸ºä»€ä¹ˆä¼šé€ æˆ <code>é‡å¤æ¶ˆè´¹</code>?<br>å› ä¸º <code>ç½‘ç»œä¼ è¾“</code> ç­‰ç­‰ <code>æ•…éšœ</code>ï¼Œç¡®è®¤ä¿¡æ¯ <code>æ²¡æœ‰</code> ä¼ é€åˆ° <code>æ¶ˆæ¯é˜Ÿåˆ—</code>ï¼Œå¯¼è‡´æ¶ˆæ¯é˜Ÿåˆ— <code>ä¸çŸ¥é“</code> è‡ªå·±å·²ç»æ¶ˆè´¹è¿‡è¯¥æ¶ˆæ¯äº†ï¼Œ<code>å†æ¬¡</code> å°†è¯¥æ¶ˆæ¯åˆ†å‘ç»™å…¶ä»–çš„æ¶ˆè´¹è€…ã€‚</li>
<li>è§£å†³é‡å¤æ¶ˆè´¹çš„æ–¹æ¡ˆï¼š<ol>
<li>æ¯”å¦‚ï¼Œä½ æ‹¿åˆ°è¿™ä¸ªæ¶ˆæ¯åšæ•°æ®åº“çš„ <code>insert</code> æ“ä½œã€‚é‚£å°±å®¹æ˜“äº†ï¼Œç»™è¿™ä¸ªæ¶ˆæ¯åšä¸€ä¸ª <code>å”¯ä¸€ä¸»é”®</code>ï¼Œé‚£ä¹ˆå°±ç®—å‡ºç°é‡å¤æ¶ˆè´¹çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´ä¸»é”®å†²çªï¼Œé¿å…æ•°æ®åº“å‡ºç°è„æ•°æ®ã€‚</li>
<li>å†æ¯”å¦‚ï¼Œä½ æ‹¿åˆ°è¿™ä¸ªæ¶ˆæ¯åš <code>redis</code> çš„setçš„æ“ä½œï¼Œé‚£å°±å®¹æ˜“äº†ï¼Œä¸ç”¨è§£å†³ï¼Œå› ä¸ºä½ æ— è®º <code>set</code> å‡ æ¬¡ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œ<code>set</code> æ“ä½œæœ¬æ¥å°±ç®— <code>å¹‚ç­‰</code> æ“ä½œã€‚</li>
<li>å¦‚æœä¸Šé¢ä¸¤ç§æƒ…å†µè¿˜ä¸è¡Œï¼Œä¸Šå¤§æ‹›ã€‚å‡†å¤‡ä¸€ä¸ª <code>ç¬¬ä¸‰æ–¹ä»‹è´¨</code>ï¼Œæ¥åšæ¶ˆè´¹è®°å½•ã€‚ä»¥ <code>redis</code> ä¸ºä¾‹ï¼Œç»™æ¶ˆæ¯åˆ†é…ä¸€ä¸ª <code>å…¨å±€id</code>ï¼Œåªè¦æ¶ˆè´¹è¿‡è¯¥æ¶ˆæ¯ï¼Œå°†&lt;id,message&gt;ä»¥K-Vå½¢å¼å†™å…¥redisã€‚é‚£æ¶ˆè´¹è€…å¼€å§‹æ¶ˆè´¹å‰ï¼Œå…ˆå»redisä¸­æŸ¥è¯¢ <code>æœ‰æ²¡æ¶ˆè´¹è®°å½•</code> å³å¯ã€‚</li>
</ol>
</li>
</ol>
<h3 id="ä¸¾ä¾‹ï¼šMDB"><a href="#ä¸¾ä¾‹ï¼šMDB" class="headerlink" title="ä¸¾ä¾‹ï¼šMDB"></a>ä¸¾ä¾‹ï¼šMDB</h3><p>MDBé€šè¿‡æ¶ˆæ¯æ–¹å¼ä¸ºè°ƒç”¨è€…æä¾›æœåŠ¡<br>MDBç»„ä»¶å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå…¶å®¢æˆ·å¹¶ä¸æ‹¥æœ‰MDBç»„ä»¶çš„è¿œç¨‹å¼•ç”¨ï¼Œè€Œæ˜¯ç›´æ¥å°†è°ƒç”¨æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå› è€Œå®¢æˆ·çš„è°ƒç”¨ä¸å¼ºè°ƒMDBç»„ä»¶çš„è¿è¡Œã€‚<br><a href="https://www.cnblogs.com/williamjie/p/9481780.html" target="_blank" rel="noopener">å‚è€ƒ</a></p>

        </div></article>
      <nav class="pagination"><a class="next" href="/page/2/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:yunduanling@naver.com" target="_blank" rel="noopener" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/paper00" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        <a href="https://github.com/paper00/paper00.github.io/issues" target="_blank" rel="noopener" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2018 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">paper</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
